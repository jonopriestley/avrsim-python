; Turns all lower case letters in the
; string to upper case then prints to
; the console

.section .data
    str: .string "lower UPPER 1234 QwErTy\n"
	
.section .text
    .global asm_function

asm_function:
	call print_fnct		; print the initial situation

	;;;;; loop set up ;;;;;
	
	ldi r27, hi8(str)	; load X with str location for the loop
	ldi r26, lo8(str)

loop:
	ld r18, X+
	cpi r18, 0
	breq end
	
						; > 96 and < 123 is a lowercase letter
	cpi r18, 97			; 97 = 0x61
	brlo loop			; Go to next character if this one isnt lower case
	cpi r18, 123		; 123 = 0x61 + 26 (26 letters)
	brsh loop			; Go to next character if this one isnt lower case

	ldi r19, 32			; 0x20
	sub r18, r19		; Upper = Lower - 32
	st -X, r18			; Store back into data
	ld r18, X+			; To increase X again to go to next letter
	
	jmp loop

print_fnct:				; Prints str string

	ldi r18, hi8(str)
	push r18			; Push @ str(high) to the stack
	ldi r18, lo8(str)
	push r18			; Push @ str(low) to the stack
	call printf			; Print str
	pop r0
	pop r0
	ret

end:
	call print_fnct
	ret

.end
